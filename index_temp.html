<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>index</title>

<!-- css -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-theme.min.css">
  <style>
   body { padding-top: 15px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-sm-3 ">
        <ul class="list-group affix" style="width:240px;">
          <li class="list-group-item">
            <form id="login-form"> <!-- login form -->
              <div class="form-group">
                <label for="login-name">Username</label>
                <input type="text" class="form-control" id="login-name" name="username" placeholder="Username">
              </div>
              <div class="form-group">
                <label for="login-pass">Password</label>
                <input type="password" class="form-control" id="login-pass" name="password" placeholder="Password">
              </div>
              
              <div class="form-group text-center" id="login-button">
                <div class="btn-group " role="group">
                  <button type="button" class="btn btn-success" data-toggle="modal" data-target="#SignupMod">Sign up</button>
                  <button type="submit" class="btn btn-default">Log in</button>
                </div>
              </div>
            </form>

            <div class="text-center" id="userinfo" style="display:none">
              <p><img src="images/default.png" class="img-circle"></p>
              <h3></h3>
              <p>Welcom to listening <br>training website</p>
              <button type="button" class="btn btn-default btn-sm" id="logout">Log out</button>
            </div>
          </li>
          <li class="list-group-item">function 1</li>
          <button type="button" class="list-group-item" data-toggle="modal" data-target="#AboutusMod">About us</button>
        </ul>
      </div> <!-- col-sm-3 end -->
      <div class="col-sm-9">
        <div class="panel panel-default">
          <!-- <div class="panel-heading">
            <h3 class="panel-title">Panel title</h3>
          </div> -->
          <div class="panel-body ">
            
            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
              <!-- Indicators -->
              <ol class="carousel-indicators">
                <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                <li data-target="#carousel-example-generic" data-slide-to="1"></li>
                <li data-target="#carousel-example-generic" data-slide-to="2"></li>
              </ol>

              <!-- Wrapper for slides -->
              <div class="carousel-inner" role="listbox">
                <div class="item active">
                  <img src="images/1.svg" alt="...">
                </div>
                <div class="item">
                  <img src="images/2.svg" alt="...">
                </div>
                <div class="item">
                  <img src="images/3.svg" alt="...">
                </div>
              </div>

              <!-- Controls -->
              <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div> <!-- slide -->
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
            <h1>abcdefghijklmnopqrstuvwxyz</h1>
          </div>
        </div> <!-- panel -->
      </div> <!-- col-sm-9 -->
    </div> <!-- row -->
  </div> <!-- container -->

<!-- Sign up modal -->
<div class="modal fade" id="SignupMod" tabindex="-1" role="dialog" aria-labelledby="SignupModLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="SignupModLabel">Signup</h4>
      </div>
      <div class="modal-body">
        
        <div class="container-fluid">
          <div class="row">
            <div class="col-sm-12">
              <form class="form-horizontal" id="signup-form">
                <div class="form-group">
                  <label for="signup-name" class="col-sm-3 control-label">用户名</label>
                  <div class="col-sm-8">
                    <input type="text" class="form-control" id="signup-name" name="username" placeholder="用户名">
                  </div>
                </div> <!-- form-group -->
                <div class="form-group">
                  <label for="signup-pass" class="col-sm-3 control-label">密码</label>
                  <div class="col-sm-8">
                    <input type="password" class="form-control" id="signup-pass" name="password" placeholder="密码">
                  </div>
                </div> <!-- form-group -->
                <div class="form-group">
                  <label for="signup-pass2" class="col-sm-3 control-label">确认密码</label>
                  <div class="col-sm-8">
                    <input type="password" class="form-control" id="signup-pass2" name="password2" placeholder="确认密码">
                  </div>
                </div> <!-- form-group -->
                <div class="form-group">
                  <label for="signup-email" class="col-sm-3 control-label">E-mail</label>
                  <div class="col-sm-8">
                    <input type="email" class="form-control" id="signup-email" name="email" placeholder="E-mail">
                  </div>
                </div> <!-- form-group -->
                <div class="form-group">
                  <label class="col-sm-3 control-label">性别</label>
                  <div class="col-sm-8">
                    <label class="radio-inline">
                      <input type="radio" name="gender" value="1" checked>男
                    </label>
                    <label class="radio-inline">
                      <input type="radio" name="gender" value="0">女
                    </label>
                  </div>
                </div> <!-- radio -->
              </form>
            </div> <!-- col-sm-12 -->
          </div> <!-- row -->
        </div> <!-- contianer-fluid -->

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="signup-button">Sign up</button>
      </div>
    </div>
  </div>
</div>


<!-- About us modal -->
<div class="modal fade" id="AboutusMod" tabindex="-1" role="dialog" aria-labelledby="AboutusModLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="AboutusModLabel">About us</h4>
      </div>
      <div class="modal-body">
        ...
      </div>
      <!-- <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div> -->
    </div>
  </div>
</div>


<!-- js -->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script>
    /**
     * Login and logout
     *
     * @author muhurta
     */
    $(document).ready(function(){
        $.ajax({
            url: "include/ajaxLogin.php",
            timeout: 1000,
            cache: false,
            dataType: "json",
            success: function(data){
                if (data.result) {
                    $("#login-form").hide();
                    $("#userinfo").show();
                    $("#userinfo h3").text(data.info.name);
                }
            }
                      
        });
        $("#login-form").submit(function(){
            var options={
                      url: "include/ajaxLogin.php?login=1",
                      timeout: 1000,
                      cache: false,
                      type: "post",
                      dataType: "json",
                      data: $("#login-form").serialize(),
                      success: function(data){
                          if (data.result) {
                              $("#login-form").hide();
                              $("#userinfo").show();
                              $("#userinfo h3").text(data.info.name);
                          }
                          else {
                              $("#login-button").before($("<div class=\"alert alert-danger alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Sorry,</strong><br>wrong username or password.</div>"));
                          }
                      },
                      error: function(){
                          alert("Something wrong with the server."); // need to change
                      }
                  };
            $.ajax(options);
            return false;
        });

        $("#logout").click(function(){
            var options={
                      url: "include/ajaxLogin.php?logout=1",
                      timeout: 1000,
                      cache: false,
                      dataType: "json",
                      success: function(data){
                          $("#userinfo").hide();
                          $("#login-form").show();
                          $("#userinfo h3").empty();
                      },
                      error: function(){
                          alert("Something wrong with the server.");
                      }
                  };
            $.ajax(options);
            return false;
        });
        $("#signup-button").click(function(){
            $("#signup-form").submit();
        })
        $("#signup-form").submit(function() {
            var options={
                      url: "include/ajaxSignUp.php",
                      timeout: 1000,
                      cache: false,
                      type: "post",
                      dataType: "json",
                      data: $("#signup-form").serialize(),
                      success: function(data){
                          if (data.result) {
                              $("#SignupMod").modal("hide")
                              $("#login-form").hide();
                              $("#userinfo").show();
                              $("#userinfo h3").text(data.info.name);
                          }
                          else alert(data.error);
                      },
                      error: function(){
                          alert("Something wrong with the server.");
                      }
                  };
              $.ajax(options);   
              return false;   
          });
    });
</script>
</body>
</html>
